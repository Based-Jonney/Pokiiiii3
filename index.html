<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>POKI ACCESS</title>

<link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}

body{
  background:#050505;
  font-family:'VT323', monospace;
  color:#00f7ff;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  overflow:hidden;
}

body::after{
  content:"";
  position:fixed;
  inset:0;
  background:repeating-linear-gradient(
    rgba(255,255,255,0.03) 0px,
    rgba(255,255,255,0.03) 1px,
    transparent 1px,
    transparent 2px
  );
  pointer-events:none;
}

.terminal{
  width:92%;
  max-width:520px;
  border:2px solid #00f7ff;
  padding:25px;
  box-shadow:0 0 30px #00f7ff55;
  background:#000;
}

.header{
  text-align:center;
  color:#fff;
  font-size:28px;
  margin-bottom:15px;
}

.line{
  display:flex;
  align-items:center;
  margin:15px 0;
}

.prompt{margin-right:6px}

input{
  flex:1;
  background:transparent;
  border:none;
  border-bottom:1px solid #00f7ff;
  color:#fff;
  font-size:20px;
  outline:none;
  font-family:'VT323', monospace;
}

#submitBtn{
  margin-top:20px;
  width:140px;
  padding:8px;
  border:1px solid #00f7ff;
  background:transparent;
  color:#00f7ff;
  font-size:20px;
  cursor:pointer;
  display:none;
}

#submitBtn:hover{
  background:#00f7ff;
  color:#000;
}

#thanks{
  position:fixed;
  inset:0;
  background:#000;
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:48px;
  color:#fff;
  display:none;
}

.error{
  color:#ff3b3b;
  font-size:18px;
  margin-top:8px;
}
</style>
</head>
<body>

<div class="terminal">
  <div class="header">POKI ACCESS TERMINAL</div>

  <div class="line">
    <span class="prompt">@username (X):</span>
    <input type="text" id="user">
  </div>

  <div class="line">
    <span class="prompt">Base addy:</span>
    <input type="text" id="wallet">
  </div>

  <div class="line">
    <span class="prompt">Like/RT link*:</span>
    <input type="text" id="link">
  </div>

  <div class="line">
    <span class="prompt">Password:</span>
    <input type="password" id="pass">
  </div>

  <div class="error" id="error"></div>

  <button id="submitBtn">SUBMIT</button>
</div>

<div id="thanks">THANKS POKI</div>

<!-- ðŸ”¥ FIREBASE SYSTEM -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDfb3gtiaD8o-4r3VtkHzs_N9eTPMVdG04",
  authDomain: "poki-c2a05.firebaseapp.com",
  projectId: "poki-c2a05",
  storageBucket: "poki-c2a05.firebasestorage.app",
  messagingSenderId: "465860717724",
  appId: "1:465860717724:web:6c9d8a54dfddb42f0a9159"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const SECRET_PASS = "im poki fan";   // ØºÙŠØ±Ù‡Ø§ ÙƒÙ„ Ù…Ø±Ø©
const MAX_SUBMISSIONS = 50;       // ØºÙŠØ± Ø§Ù„Ø¹Ø¯Ø¯ Ù…Ù† Ù‡Ù†Ø§

const passInput = document.getElementById("pass");
const submitBtn = document.getElementById("submitBtn");
const error = document.getElementById("error");

passInput.addEventListener("input", () => {
  if(passInput.value === SECRET_PASS){
    submitBtn.style.display = "block";
    error.textContent = "";
  } else {
    submitBtn.style.display = "none";
    error.textContent = "Wrong Access Code";
  }
});

submitBtn.addEventListener("click", async () => {

  const snapshot = await getDocs(collection(db, "submissions"));
  if(snapshot.size >= MAX_SUBMISSIONS){
    document.querySelector(".terminal").style.display = "none";
    document.getElementById("thanks").innerText = "FORM ENDED";
    document.getElementById("thanks").style.display = "flex";
    return;
  }

  await addDoc(collection(db, "submissions"), {
    username: document.getElementById("user").value,
    wallet: document.getElementById("wallet").value,
    link: document.getElementById("link").value,
    time: new Date()
  });

  document.querySelector(".terminal").style.display = "none";
  document.getElementById("thanks").innerText = "THANKS POKI";
  document.getElementById("thanks").style.display = "flex";
});
</script>

</body>
</html>